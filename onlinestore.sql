SQL> SELECT DISTINCT C.CustomerID, C.CustomerName, C.CustomerMail, C.CustomerAddress, C.CustomerPhone, C.CustomerCategory
  2  FROM Customer C
  3  JOIN CustomerType CT ON C.CustomerCategory = CT.CustomerCategory
  4  WHERE CT.CustomerCategory = 'Staff';

CUSTOMERID CUSTOMERNAME                                       CUSTOMERMAIL                                       CUSTOMERADDRESS                                    CUSTOMERPHONE   CUSTOMERCATEGORY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
---------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- --------------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       551 Viper Maharjan                                     vipermaharjan4@gmail.com                           Bhotebhal                                          98450002101     Staff                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       552 Harbour Kumar                                      harbourkumaro@gmail.com                            Balaju                                             98450002100     Staff                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT O.OrderID, O.OrderDate, O.OrderStatus, O.TotalAmount, Q.ProductID, Q.ProductOrderQuantity
  2  FROM Orders O
  3  JOIN QuantityUnit Q ON O.OrderID = Q.OrderID
  4  WHERE O.OrderDate BETWEEN TO_DATE('2023-05-01', 'YYYY-MM-DD') AND TO_DATE('2023-05-28', 'YYYY-MM-DD');

   ORDERID ORDERDATE ORDERSTATUS          TOTALAMOUNT  PRODUCTID PRODUCTORDERQUANTITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
---------- --------- -------------------- ----------- ---------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       102 12-MAY-23 Processing                  9588        101                   12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       103 15-MAY-23 Processing                  1432        987                    8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       104 25-MAY-23 Delivered                    798        124                    2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> SELECT C.CustomerID, C.CustomerName, C.Customerphone, C.CustomerCategory,
  2  Q.OrderID, Q.ProductOrderQuantity FROM Customer C LEFT
  3  JOIN QuantityUnit Q
  4  ON C.CustomerID = Q.CustomerID;

CUSTOMERID CUSTOMERNAME                                       CUSTOMERPHONE   CUSTOMERCATEGORY        ORDERID PRODUCTORDERQUANTITY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
---------- -------------------------------------------------- --------------- -------------------- ---------- --------------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       546 Astra Khanal                                       98450002136     VIP                         102                   12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       546 Astra Khanal                                       98450002136     VIP                         103                    8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       548 Breach Bhattari                                    98450002133     Regular                     104                    2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       549 Raze RajBhandari                                   98450002156     VIP                         105                    4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       550 Sova Shrestha                                      98450002178     Regular                     106                    1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       551 Viper Maharjan                                     98450002101     Staff                       107                   12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       550 Sova Shrestha                                      98450002178     Regular                     108                   15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       552 Harbour Kumar                                      98450002100     Staff                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

8 rows selected.

SQL> SELECT *
  2  FROM Product
  3  WHERE SUBSTR(ProductName, 2, 1) = 'a'
  4  AND ProductQuantity > 50;

 PRODUCTID PRODUCTNAME                                        PRODUCTDESCRIPTION                                                               PRO PRODUCTPRICE PRODUCTQUANTITY PRODUCTCATEGORY                                      VENDORID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
---------- -------------------------------------------------- -------------------------------------------------------------------------------- --- ------------ --------------- -------------------------------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       698 Galaxy S22                                         With a vibrant display and long battery life, it is your go-to device for produc Yes          919              52 Smartphone                                                 51                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

SQL> set linesize 900;
SQL> SELECT *
  2  FROM Product
  3  WHERE SUBSTR(ProductName, 2, 1) = 'a'
  4  AND ProductQuantity > 50;

 PRODUCTID PRODUCTNAME                                        PRODUCTDESCRIPTION                                                               PRO PRODUCTPRICE PRODUCTQUANTITY PRODUCTCATEGORY                                      VENDORID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
---------- -------------------------------------------------- -------------------------------------------------------------------------------- --- ------------ --------------- -------------------------------------------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       698 Galaxy S22                                         With a vibrant display and long battery life, it is your go-to device for produc Yes          919              52 Smartphone                                                 51                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> SELECT *
  2  FROM (SELECT * FROM Orders ORDER BY orderdate DESC)
  3  WHERE ROWNUM = 1;

   ORDERID ORDERDATE ORDERSTATUS          TOTALAMOUNT  PAYMENTID  INVOICEID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- --------- -------------------- ----------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       108 14-JAN-24 On the way                 26985        957         17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> SELECT EXTRACT(YEAR FROM orderdate) AS year,
  2  EXTRACT(MONTH FROM orderdate) AS month,
  3  SUM(totalamount) AS total_revenue
  4  FROM Orders
  5  GROUP BY EXTRACT(YEAR FROM orderdate), EXTRACT(MONTH FROM orderdate)
  6  ORDER BY year, month;

      YEAR      MONTH TOTAL_REVENUE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- ---------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      2023          5         11818                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      2023          8          2396                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      2023          9           129                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
      2024          1         38013                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> SELECT *
  2  FROM Orders
  3  WHERE TotalAmount >= (SELECT AVG(TotalAmount) FROM Orders);

   ORDERID ORDERDATE ORDERSTATUS          TOTALAMOUNT  PAYMENTID  INVOICEID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- --------- -------------------- ----------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       102 12-MAY-23 Processing                  9588        953         25                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       107 09-JAN-24 Delivered                  11028        952         12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       108 14-JAN-24 On the way                 26985        957         17                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> SELECT v.VendorID, v.VendorName, v.VendorAddress, v.VendorPhone
  2  FROM Vendor v
  3  JOIN Product p ON v.VendorID = p.VendorID
  4  GROUP BY v.VendorID, v.VendorName, v.VendorAddress, v.VendorPhone
  5  HAVING COUNT(p.ProductID) > 3;

  VENDORID VENDORNAME                                         VENDORADDRESS                                      VENDORPHONE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
---------- -------------------------------------------------- -------------------------------------------------- ---------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
        55 NepaliTech Traders                                 Bhaktapur                                          9800000005                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
        54 Annapurna Digital                                  Budhanilkantha                                     9800000004                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> SELECT ProductID, ProductName, ProductDescription, ProductPrice
  2  FROM (
  3  SELECT p.ProductID, p.ProductName, p.ProductDescription, p.ProductPrice
  4  FROM QuantityUnit qu
  5  JOIN Product p ON qu.ProductID = p.ProductID
  6  ORDER BY p.ProductID
  7  )
  8  WHERE ROWNUM <= 3;

 PRODUCTID PRODUCTNAME                                        PRODUCTDESCRIPTION                                                               PRODUCTPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- -------------------------------------------------- -------------------------------------------------------------------------------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       101 Iphone 15                                          Flagship smartphone with advanced tech, sleek design, and powerful performance.           799                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       124 WH-1000XM5                                         Top-tier noise-canceling headphones with exceptional sound and comfort.                   399                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       405 Fitbit 5                                           Leading smartwatch for fitness enthusiasts, featuring heart rate monitoring and           129                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         

SQL> set linesize 1200;
SQL> SELECT ProductID, ProductName, ProductDescription, ProductPrice
  2  FROM (
  3  SELECT p.ProductID, p.ProductName, p.ProductDescription, p.ProductPrice
  4  FROM QuantityUnit qu
  5  JOIN Product p ON qu.ProductID = p.ProductID
  6  ORDER BY p.ProductID
  7  )
  8  WHERE ROWNUM <= 3;

 PRODUCTID PRODUCTNAME                                        PRODUCTDESCRIPTION                                                               PRODUCTPRICE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
---------- -------------------------------------------------- -------------------------------------------------------------------------------- ------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       101 Iphone 15                                          Flagship smartphone with advanced tech, sleek design, and powerful performance.           799                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       124 WH-1000XM5                                         Top-tier noise-canceling headphones with exceptional sound and comfort.                   399                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       405 Fitbit 5                                           Leading smartwatch for fitness enthusiasts, featuring heart rate monitoring and           129                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     

SQL> SELECT CustomerID, CustomerName, TotalSpending
  2  FROM (
  3  SELECT c.CustomerID, c.CustomerName, SUM(p.PaymentAmount) AS TotalSpending,
  4  RANK() OVER (ORDER BY SUM(p.PaymentAmount) DESC) AS SpendingRank
  5  FROM Customer c
  6  JOIN QuantityUnit qu ON c.CustomerID = qu.CustomerID
  7  JOIN Orders o ON qu.OrderID = o.OrderID
  8  JOIN Payment p ON o.PaymentID = p.PaymentID
  9  WHERE TO_CHAR(o.OrderDate, 'MM/YYYY') = '08/2023'
 10  GROUP BY c.CustomerID, c.CustomerName
 11  )
 12  WHERE SpendingRank = 1;

CUSTOMERID CUSTOMERNAME                                       TOTALSPENDING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
---------- -------------------------------------------------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       549 Raze RajBhandari                                          2156.4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     

SQL> SPOOL OFF
